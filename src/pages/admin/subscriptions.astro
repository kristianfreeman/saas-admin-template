---
import Layout from '@/layouts/Layout.astro';
import { getSubscriptions } from '@/lib/api';

const baseUrl = Astro.url.origin;
const subscriptionsResponse = await getSubscriptions(baseUrl);

import { CreateSubscriptionButton } from '@/components/admin/create-subscription';
import { SubscriptionsTable } from '@/components/admin/subscriptions-table';
---

<Layout title="Subscriptions">
  {subscriptionsResponse.success ? (
    <SubscriptionsTable data={subscriptionsResponse.subscriptions} />
  ) : (
    <p>No subscriptions yet</p>
  )}

  <div slot="actions">
    <CreateSubscriptionButton client:only="react" />
  </div>
</Layout>
